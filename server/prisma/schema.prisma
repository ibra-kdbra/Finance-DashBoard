generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  username  String   @unique
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Product {
  id           String        @id @default(uuid())
  price        Decimal       @db.Decimal(10, 2)
  expense      Decimal       @db.Decimal(10, 2)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  transactions Transaction[] @relation("ProductTransactions")
}

model Transaction {
  id        String    @id @default(uuid())
  buyer     String
  amount    Decimal   @db.Decimal(10, 2)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  products  Product[] @relation("ProductTransactions")
}

model KPI {
  id                 String      @id @default(uuid())
  totalProfit        Decimal     @db.Decimal(10, 2)
  totalRevenue       Decimal     @db.Decimal(10, 2)
  totalExpenses      Decimal     @db.Decimal(10, 2)
  expensesByCategory Json
  createdAt          DateTime    @default(now())
  updatedAt          DateTime    @updatedAt
  dailyData          DayData[]
  monthlyData        MonthData[]
}

model MonthData {
  id                     String  @id @default(uuid())
  month                  String
  revenue                Decimal @db.Decimal(10, 2)
  expenses               Decimal @db.Decimal(10, 2)
  operationalExpenses    Decimal @db.Decimal(10, 2)
  nonOperationalExpenses Decimal @db.Decimal(10, 2)
  kpiId                  String
  kpi                    KPI     @relation(fields: [kpiId], references: [id])
}

model DayData {
  id       String  @id @default(uuid())
  date     String
  revenue  Decimal @db.Decimal(10, 2)
  expenses Decimal @db.Decimal(10, 2)
  kpiId    String
  kpi      KPI     @relation(fields: [kpiId], references: [id])
}
